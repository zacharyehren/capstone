!function(){angular.module("capstone",["ui.router","ui.bootstrap","ngCookies","ngRoute"]).config(function(t,e){t.html5Mode({enabled:!0,requireBase:!1}),e.state("home",{url:"/",controller:"HomeCtrl as home",templateUrl:"/templates/home.html"}).state("ticket",{url:"/ticket",controller:"TicketCtrl as ticket",templateUrl:"/templates/ticket.html"}).state("closedTickets",{url:"/closed-tickets",controller:"ClosedTicketCtrl as closedTickets",templateUrl:"/templates/closedTickets.html"}).state("newTicket",{url:"/new-ticket",controller:"NewTicketCtrl as newTicket",templateUrl:"/templates/newTicket.html"}).state("myTickets",{url:"/my-tickets",controller:"MyTicketCtrl as myTickets",templateUrl:"/templates/myTicket.html"})})}(),function(){angular.module("capstone").factory("GoogleOauth",["ZenFactory","$cookies",function(t,e){var s,o,n={signOut:function(){gapi.auth2.getAuthInstance().signOut().then(function(){console.log("User signed out.")})}};return window.onSignIn=function(t){o=t.getBasicProfile(),domain=t.getHostedDomain(),"sharethrough.com"==domain?null==e.get("zendeskUserEmail")&&(s={name:o.getName(),email:o.getEmail()},n.userObject=s,e.put("zendeskUserEmail",s.email),e.put("zendeskUserName",s.name),location.reload()):(alert("Only Sharethrough emails have access."),n.signOut())},n}])}(),function(){angular.module("capstone").factory("SortData",["ZenFactory","$cookies",function t(e,s){var o="",n="";return t.ticketSort=function(t,s){""==o||"desc"==o||n!=t?(o="asc",n=t,e[s].ticket.sort(function(e,s){return e[t].localeCompare(s[t])})):"asc"==o&&(o="desc",e[s].ticket.sort(function(e,s){return s[t].localeCompare(e[t])}))},t}])}(),function(){angular.module("capstone").factory("ZenFactory",["$http","$cookies",function(t,e){var s={},o=function(t){for(var e=t.ticket,s=t.incidents,o=0;o<e.length;o++)for(var n=0;n<s.length;n++)e[o].id==s[n].problem_id&&(e[o].hasIncident=!0)};return s.listTickets=function(){return t({method:"GET",url:"http://localhost:3000/api/tickets"}).then(function(t){s.unsolvedTickets=t.data,o(s.unsolvedTickets)})},s.listClosedTickets=function(){return t({method:"GET",url:"http://localhost:3000/api/closed_tickets"}).then(function(t){s.closedTickets=t.data,o(s.closedTickets),console.log(s.closedTickets)})},s.listMyTickets=function(){var o={method:"GET",url:"http://localhost:3000/api/my_tickets",params:{user_email:e.get("zendeskUserEmail")}};return t(o).then(function(t){s.myTicketData=t.data})},s.createTicket=function(o,n){var i={method:"POST",url:"http://localhost:3000/api/tickets",data:{subject:o,comment_body:n,submitter_email:e.get("zendeskUserEmail"),submitter_name:e.get("zendeskUserName")}};t(i).then(function(t){s.newTicket=t.data})},s.returnTicket=function(){var o={method:"GET",url:"http://localhost:3000/api/tickets/"+e.get("zendeskTicketId")};return t(o).then(function(t){s.ticket=t.data})},s.createComment=function(o){var n={method:"POST",url:"http://localhost:3000/api/tickets/new_comment",data:{user_email:e.get("zendeskUserEmail"),comment_body:o,id:e.get("zendeskTicketId")}};t(n).then(function(t){s.newComment=t.data})},s}])}(),function(){angular.module("capstone").controller("ClosedTicketCtrl",["GoogleOauth","ZenFactory","SortData","$cookies","$location","$anchorScroll","$scope","$stateParams",function(t,e,s,o,n,i,c,a){this.sortClass="",this.selected="",this.sortData=function(t){this.selected!=t&&(this.sortClass=""),this.selected=t,""==this.sortClass||"down-carat"==this.sortClass?(this.sortClass="up-carat",s.ticketSort(t,"closedTickets")):"up-carat"==this.sortClass&&(this.sortClass="down-carat",s.ticketSort(t,"closedTickets"))},this.loading=!0;var r=function(){this.loading=!1};r=r.bind(this),e.listClosedTickets().then(r),this.ZenFactory=e,this.passTicketInfo=function(t,e){o.put("zendeskTicketId",t),o.put("zendeskTicketSubject",e)},c.$watchCollection("$stateParams",function(){i()})}])}(),function(){angular.module("capstone").controller("HomeCtrl",["GoogleOauth","ZenFactory","SortData","$cookies","$location","$anchorScroll","$scope","$stateParams",function(t,e,s,o,n,i,c,a){this.sortClass="",this.selected="",this.sortData=function(t){this.selected!=t&&(this.sortClass=""),this.selected=t,""==this.sortClass||"down-carat"==this.sortClass?(this.sortClass="up-carat",s.ticketSort(t,"unsolvedTickets")):"up-carat"==this.sortClass&&(this.sortClass="down-carat",s.ticketSort(t,"unsolvedTickets"))},this.userSignedOut=function(){return null==o.get("zendeskUserEmail")},this.loading=!0;var r=function(){this.loading=!1};r=r.bind(this),null!=o.get("zendeskUserEmail")?e.listTickets().then(r):r(),this.ZenFactory=e,this.passTicketInfo=function(t,e){o.put("zendeskTicketId",t),o.put("zendeskTicketSubject",e)},c.$watchCollection("$stateParams",function(){i()})}])}(),function(){angular.module("capstone").controller("IncidentsModalCtrl",["$uibModal",function(t){this.openModal=function(e,s){t.open({animation:this.animationsEnabled,templateUrl:"/templates/incidentsModal.html",controller:"IncidentsModalInstanceCtrl",controllerAs:"incidentsModal",resolve:{selectedTicketId:e,ZenFactoryObject:s}})}}])}(),function(){angular.module("capstone").controller("IncidentsModalInstanceCtrl",["$uibModalInstance","ZenFactory","SortData","$cookies","selectedTicketId","ZenFactoryObject",function(t,e,s,o,n,i){this.sortClass="",this.selected="",this.selectedTicket=n,this.ZenFactoryObject=i,this.sortData=function(t){this.selected!=t&&(this.sortClass=""),this.selected=t,""==this.sortClass||"down-carat"==this.sortClass?(this.sortClass="up-carat",this.incidentsArray.sort(function(e,s){return e[t].localeCompare(s[t])})):"up-carat"==this.sortClass&&(this.sortClass="down-carat",this.incidentsArray.sort(function(e,s){return s[t].localeCompare(e[t])}))};var c=function(){this.incidentsArray=[];for(var t=this.ZenFactoryObject.incidents,e=0;e<t.length;e++)this.selectedTicket==t[e].problem_id&&this.incidentsArray.push(t[e])};(c=c.bind(this))(),this.ZenFactory=e,this.ticketSubject=o.get("zendeskTicketSubject"),this.passTicketInfo=function(e,s){o.put("zendeskTicketId",e),o.put("zendeskTicketSubject",s),t.close()}}])}(),function(){angular.module("capstone").controller("IndexCtrl",["GoogleOauth","ZenFactory","$cookies",function(t,e,s){this.userSignedIn=function(){return null!=s.get("zendeskUserEmail")},this.ZenFactory=e,this.user=s.get("zendeskUserName"),this.signOut=function(){t.signOut();var e=s.getAll();angular.forEach(e,function(t,e){s.remove(e)}),window.location="/"}}])}(),function(){angular.module("capstone").controller("MyTicketCtrl",["GoogleOauth","ZenFactory","SortData","$cookies","$location","$anchorScroll","$scope","$stateParams",function(t,e,s,o,n,i,c,a){this.sortClass="",this.selected="",this.sortData=function(t){this.selected!=t&&(this.sortClass=""),this.selected=t,""==this.sortClass||"down-carat"==this.sortClass?(this.sortClass="up-carat",s.ticketSort(t,"myTicketData")):"up-carat"==this.sortClass&&(this.sortClass="down-carat",s.ticketSort(t,"myTicketData"))},this.loading=!0;var r=function(){this.loading=!1};r=r.bind(this),e.listMyTickets().then(r),this.ZenFactory=e,this.passTicketInfo=function(t,e){o.put("zendeskTicketId",t),o.put("zendeskTicketSubject",e)},c.$watchCollection("$stateParams",function(){i()})}])}(),function(){angular.module("capstone").controller("NewTicketCtrl",["GoogleOauth","ZenFactory","$cookies","$location",function(t,e,s,o){this.ZenFactory=e,this.submitter=s.get("zendeskUserEmail"),this.createTicket=function(){e.createTicket(this.subject,this.comment),o.path("/")}}])}(),function(){angular.module("capstone").controller("TicketCtrl",["ZenFactory","$cookies","$location","$anchorScroll","$scope","$stateParams",function(t,e,s,o,n,i){this.loading=!0;var c=function(){this.loading=!1};c=c.bind(this),t.returnTicket().then(c),this.ZenFactory=t,this.ticketSubject=e.get("zendeskTicketSubject"),this.createComment=function(){this.submitted=!0,t.createComment(this.commentBody),location.reload()},n.$watchCollection("$stateParams",function(){o()})}])}();