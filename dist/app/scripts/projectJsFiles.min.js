!function(){angular.module("capstone").factory("GoogleOauth",["ZenFactory","$cookies",function(t,e){var s,n,o={signOut:function(){gapi.auth2.getAuthInstance().signOut().then(function(){console.log("User signed out.")})}};return window.onSignIn=function(t){n=t.getBasicProfile(),domain=t.getHostedDomain(),"sharethrough.com"==domain?null==e.get("zendeskUserEmail")&&(s={name:n.getName(),email:n.getEmail()},o.userObject=s,e.put("zendeskUserEmail",s.email),e.put("zendeskUserName",s.name),location.reload()):(alert("Only Sharethrough emails have access."),o.signOut())},o}])}(),function(){angular.module("capstone").factory("SortData",["ZenFactory","$cookies",function t(e,s){var n="",o="";return t.ticketSort=function(t,s){""==n||"desc"==n||o!=t?(n="asc",o=t,e[s].ticket.sort(function(e,s){return e[t].localeCompare(s[t])})):"asc"==n&&(n="desc",e[s].ticket.sort(function(e,s){return s[t].localeCompare(e[t])}))},t}])}(),function(){angular.module("capstone").factory("ZenFactory",["$http","$cookies",function(t,e){var s={},n=function(t){for(var e=t.ticket,s=t.incidents,n=0;n<e.length;n++)for(var o=0;o<s.length;o++)e[n].id==s[o].problem_id&&(e[n].hasIncident=!0)};return s.listTickets=function(){return t({method:"GET",url:"http://localhost:3000/api/tickets"}).then(function(t){s.unsolvedTickets=t.data,n(s.unsolvedTickets)})},s.listClosedTickets=function(){return t({method:"GET",url:"http://localhost:3000/api/closed_tickets"}).then(function(t){s.closedTickets=t.data,n(s.closedTickets),console.log(s.closedTickets)})},s.listMyTickets=function(){var n={method:"GET",url:"http://localhost:3000/api/my_tickets",params:{user_email:e.get("zendeskUserEmail")}};return t(n).then(function(t){s.myTicketData=t.data})},s.createTicket=function(n,o){var i={method:"POST",url:"http://localhost:3000/api/tickets",data:{subject:n,comment_body:o,submitter_email:e.get("zendeskUserEmail"),submitter_name:e.get("zendeskUserName")}};t(i).then(function(t){s.newTicket=t.data})},s.returnTicket=function(){var n={method:"GET",url:"http://localhost:3000/api/tickets/"+e.get("zendeskTicketId")};return t(n).then(function(t){s.ticket=t.data})},s.createComment=function(n){var o={method:"POST",url:"http://localhost:3000/api/tickets/new_comment",data:{user_email:e.get("zendeskUserEmail"),comment_body:n,id:e.get("zendeskTicketId")}};t(o).then(function(t){s.newComment=t.data})},s}])}(),function(){angular.module("capstone").controller("ClosedTicketCtrl",["GoogleOauth","ZenFactory","SortData","$cookies","$location","$anchorScroll","$scope","$stateParams",function(t,e,s,n,o,i,a,c){this.sortClass="",this.selected="",this.sortData=function(t){this.selected!=t&&(this.sortClass=""),this.selected=t,""==this.sortClass||"down-carat"==this.sortClass?(this.sortClass="up-carat",s.ticketSort(t,"closedTickets")):"up-carat"==this.sortClass&&(this.sortClass="down-carat",s.ticketSort(t,"closedTickets"))},this.loading=!0;var r=function(){this.loading=!1};r=r.bind(this),e.listClosedTickets().then(r),this.ZenFactory=e,this.passTicketInfo=function(t,e){n.put("zendeskTicketId",t),n.put("zendeskTicketSubject",e)},a.$watchCollection("$stateParams",function(){i()})}])}(),function(){angular.module("capstone").controller("HomeCtrl",["GoogleOauth","ZenFactory","SortData","$cookies","$location","$anchorScroll","$scope","$stateParams",function(t,e,s,n,o,i,a,c){this.sortClass="",this.selected="",this.sortData=function(t){this.selected!=t&&(this.sortClass=""),this.selected=t,""==this.sortClass||"down-carat"==this.sortClass?(this.sortClass="up-carat",s.ticketSort(t,"unsolvedTickets")):"up-carat"==this.sortClass&&(this.sortClass="down-carat",s.ticketSort(t,"unsolvedTickets"))},this.userSignedOut=function(){return null==n.get("zendeskUserEmail")},this.loading=!0;var r=function(){this.loading=!1};r=r.bind(this),null!=n.get("zendeskUserEmail")?e.listTickets().then(r):r(),this.ZenFactory=e,this.passTicketInfo=function(t,e){n.put("zendeskTicketId",t),n.put("zendeskTicketSubject",e)},a.$watchCollection("$stateParams",function(){i()})}])}(),function(){angular.module("capstone").controller("IncidentsModalCtrl",["$uibModal",function(t){this.openModal=function(e,s){t.open({animation:this.animationsEnabled,templateUrl:"/templates/incidentsModal.html",controller:"IncidentsModalInstanceCtrl",controllerAs:"incidentsModal",resolve:{selectedTicketId:e,ZenFactoryObject:s}})}}])}(),function(){angular.module("capstone").controller("IncidentsModalInstanceCtrl",["$uibModalInstance","ZenFactory","SortData","$cookies","selectedTicketId","ZenFactoryObject",function(t,e,s,n,o,i){this.sortClass="",this.selected="",this.selectedTicket=o,this.ZenFactoryObject=i,this.sortData=function(t){this.selected!=t&&(this.sortClass=""),this.selected=t,""==this.sortClass||"down-carat"==this.sortClass?(this.sortClass="up-carat",this.incidentsArray.sort(function(e,s){return e[t].localeCompare(s[t])})):"up-carat"==this.sortClass&&(this.sortClass="down-carat",this.incidentsArray.sort(function(e,s){return s[t].localeCompare(e[t])}))};var a=function(){this.incidentsArray=[];for(var t=this.ZenFactoryObject.incidents,e=0;e<t.length;e++)this.selectedTicket==t[e].problem_id&&this.incidentsArray.push(t[e])};(a=a.bind(this))(),this.ZenFactory=e,this.ticketSubject=n.get("zendeskTicketSubject"),this.passTicketInfo=function(e,s){n.put("zendeskTicketId",e),n.put("zendeskTicketSubject",s),t.close()}}])}(),function(){angular.module("capstone").controller("IndexCtrl",["GoogleOauth","ZenFactory","$cookies",function(t,e,s){this.userSignedIn=function(){return null!=s.get("zendeskUserEmail")},this.ZenFactory=e,this.user=s.get("zendeskUserName"),this.signOut=function(){t.signOut();var e=s.getAll();angular.forEach(e,function(t,e){s.remove(e)}),window.location="/"}}])}(),function(){angular.module("capstone").controller("MyTicketCtrl",["GoogleOauth","ZenFactory","SortData","$cookies","$location","$anchorScroll","$scope","$stateParams",function(t,e,s,n,o,i,a,c){this.sortClass="",this.selected="",this.sortData=function(t){this.selected!=t&&(this.sortClass=""),this.selected=t,""==this.sortClass||"down-carat"==this.sortClass?(this.sortClass="up-carat",s.ticketSort(t,"myTicketData")):"up-carat"==this.sortClass&&(this.sortClass="down-carat",s.ticketSort(t,"myTicketData"))},this.loading=!0;var r=function(){this.loading=!1};r=r.bind(this),e.listMyTickets().then(r),this.ZenFactory=e,this.passTicketInfo=function(t,e){n.put("zendeskTicketId",t),n.put("zendeskTicketSubject",e)},a.$watchCollection("$stateParams",function(){i()})}])}(),function(){angular.module("capstone").controller("NewTicketCtrl",["GoogleOauth","ZenFactory","$cookies","$location",function(t,e,s,n){this.ZenFactory=e,this.submitter=s.get("zendeskUserEmail"),this.createTicket=function(){e.createTicket(this.subject,this.comment),n.path("/")}}])}(),function(){angular.module("capstone").controller("TicketCtrl",["ZenFactory","$cookies","$location","$anchorScroll","$scope","$stateParams",function(t,e,s,n,o,i){this.loading=!0;var a=function(){this.loading=!1};a=a.bind(this),t.returnTicket().then(a),this.ZenFactory=t,this.ticketSubject=e.get("zendeskTicketSubject"),this.createComment=function(){this.submitted=!0,t.createComment(this.commentBody),location.reload()},o.$watchCollection("$stateParams",function(){n()})}])}();